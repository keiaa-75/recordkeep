<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${pageTitle} + ' | RecordKeep'">Student Form</title>
    <link th:href="@{/webjars/bootstrap/5.3.3/css/bootstrap.min.css}" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style> body { background-color: #f8f9fa; } </style>
</head>
<body class="bg-light">

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" th:href="@{/}"><i class="bi bi-shield-check"></i> GATE KEEP</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="mainNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" th:href="@{/scan}">Scan</a></li>
                    <li class="nav-item"><a class="nav-link" th:href="@{/report}">Attendance</a></li>
                    <li class="nav-item"><a class="nav-link" th:href="@{/list}">Student List</a></li>
                    <li class="nav-item"><a class="nav-link" th:href="@{/qr-code}">QR Code</a></li>
                </ul>
                <a class="btn btn-outline-light" th:href="@{/}"><i class="bi bi-house-door-fill"></i> Back to Dashboard</a>
            </div>
        </div>
    </nav>

    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow-sm">
                    <div class="card-body p-5">
                        <h2 class="card-title mb-4" th:text="${pageTitle}">Add/Edit Student</h2>

                        <form th:action="@{/list/save}" th:object="${student}" method="post">
                            
                            <div class="mb-3">
                                <label for="lrn" class="form-label">LRN (12 Digits)</label>
                                <input type="text" th:field="*{lrn}" class="form-control" id="lrn" 
                                       pattern="\d{12}" maxlength="12" required
                                       th:attr="readonly=${pageTitle == 'Edit Student'}"
                                       th:classappend="${#fields.hasErrors('lrn')} ? 'is-invalid' : ''">
                                <div th:if="${#fields.hasErrors('lrn')}" class="invalid-feedback d-block" th:errors="*{lrn}"></div>
                            </div>

                            <div class="row">
                                <div class="col-md-5 mb-3">
                                    <label for="surname" class="form-label">Surname</label>
                                    <input type="text" th:field="*{surname}" class="form-control" id="surname" required
                                           th:classappend="${#fields.hasErrors('surname')} ? 'is-invalid' : ''">
                                    <div th:if="${#fields.hasErrors('surname')}" class="invalid-feedback d-block" th:errors="*{surname}"></div>
                                </div>
                                <div class="col-md-5 mb-3">
                                    <label for="firstName" class="form-label">First Name</label>
                                    <input type="text" th:field="*{firstName}" class="form-control" id="firstName" required
                                           th:classappend="${#fields.hasErrors('firstName')} ? 'is-invalid' : ''">
                                    <div th:if="${#fields.hasErrors('firstName')}" class="invalid-feedback d-block" th:errors="*{firstName}"></div>
                                </div>
                                <div class="col-md-2 mb-3">
                                    <label for="middleInitial" class="form-label">M.I.</label>
                                    <input type="text" th:field="*{middleInitial}" class="form-control" id="middleInitial" maxlength="5">
                                    <div th:if="${#fields.hasErrors('middleInitial')}" class="invalid-feedback d-block" th:errors="*{middleInitial}"></div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label for="gradeLevel" class="form-label">Grade Level (11 or 12)</label>
                                    <select th:field="*{gradeLevel}" class="form-select" id="gradeLevel" required
                                            th:classappend="${#fields.hasErrors('gradeLevel')} ? 'is-invalid' : ''">
                                        <option value="">Select Grade...</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                    </select>
                                    <div th:if="${#fields.hasErrors('gradeLevel')}" class="invalid-feedback d-block" th:errors="*{gradeLevel}"></div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="strand" class="form-label">Strand</label>
                                    <select th:field="*{strand}" class="form-select" id="strand" required
                                            th:classappend="${#fields.hasErrors('strand')} ? 'is-invalid' : ''">
                                        <option value="">Select Strand...</option>
                                        <option value="STEM">STEM</option>
                                        <option value="TVL">TVL</option>
                                        <option value="HUMSS">HUMSS</option>
                                        <option value="ABM">ABM</option>
                                        <option value="GAS">GAS</option>
                                    </select>
                                    <div th:if="${#fields.hasErrors('strand')}" class="invalid-feedback d-block" th:errors="*{strand}"></div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="section" class="form-label">Section (Auto-Caps)</label>
                                    <input type="text" th:field="*{section}" class="form-control" id="section" required
                                           oninput="this.value = this.value.toUpperCase()"
                                           th:classappend="${#fields.hasErrors('section')} ? 'is-invalid' : ''">
                                    <div th:if="${#fields.hasErrors('section')}" class="invalid-feedback d-block" th:errors="*{section}"></div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="sex" class="form-label">Sex</label>
                                <select th:field="*{sex}" class="form-select" id="sex" required
                                        th:classappend="${#fields.hasErrors('sex')} ? 'is-invalid' : ''">
                                    <option value="">Select Sex...</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                </select>
                                <div th:if="${#fields.hasErrors('sex')}" class="invalid-feedback d-block" th:errors="*{sex}"></div>
                            </div>

                            <hr class="my-4">
                            <div class="d-flex justify-content-end">
                                <a th:href="@{/list}" class="btn btn-secondary me-2">Cancel</a>
                                <button type="submit" class="btn btn-primary">Save Student</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="container text-center text-muted mt-5 mb-3">
        <hr>
        <p>&copy; 2025 RecordKeep System. All rights reserved.</p>
    </footer>

    <script th:src="@{/webjars/bootstrap/5.3.3/js/bootstrap.bundle.min.js}"></script>
</body>
</html>